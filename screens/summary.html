<div class="summary-screen min-vh-100" style="background: linear-gradient(to bottom, #0a0a0a, #000000);">
  <div class="container px-4 py-4">

    <!-- Success Badge -->
    <div class="text-center mb-4 pt-4 fade-in">
      <div class="success-badge mx-auto mb-4 pulse" 
           style="width: 100px; height: 100px; border-radius: 50%; 
           background: linear-gradient(135deg, #06b6d4, #10b981); 
           display:flex; align-items:center; justify-content:center;">
        <i class="bi bi-check-lg" style="font-size: 60px; color: white; font-weight: bold;"></i>
      </div>

      <h2 class="fw-bold mb-2">Great Session!</h2>
      <p class="text-muted">You're making excellent progress</p>
    </div>

   <!-- Main Score Card -->
    <div class="card border-cyan mb-4"
     style="background: linear-gradient(135deg, rgba(6, 182, 212, 0.1), rgba(168, 85, 247, 0.1));">
    <div class="card-body p-4 text-center">

    <small class="text-muted d-block mb-2">Average Posture Score</small>

    <h1 class="display-1 fw-bold mb-3"
        style="background: linear-gradient(135deg, var(--neon-cyan), var(--neon-green));
               -webkit-background-clip: text;
               background-clip: text;
               -webkit-text-fill-color: transparent;
               color: transparent;">
      <span id="summaryScore">0</span>%
    </h1>

    <div class="progress" style="height: 12px; border-radius: 10px;">
      <div id="summaryScoreBar" class="progress-bar" 
           style="width: 0%; background: linear-gradient(90deg, var(--neon-cyan), var(--neon-green));">
      </div>
    </div>

  </div>
</div>


    <!-- Stats Grid -->
    <div class="row g-3 mb-4">

      <div class="col-6">
        <div class="card border-purple h-100">
          <div class="card-body p-3 text-center">
            <i class="bi bi-clock-history fs-3 text-purple mb-2"></i>
            <h4 class="fw-bold mb-1" id="summaryDuration">0:00</h4>
            <small class="text-muted">Duration</small>
          </div>
        </div>
      </div>

      <div class="col-6">
        <div class="card border-pink h-100">
          <div class="card-body p-3 text-center">
            <i class="bi bi-music-note fs-3 text-pink mb-2"></i>
            <h4 class="fw-bold mb-1"><span id="summaryBPM">0</span> BPM</h4>
            <small class="text-muted">Average Beat</small>
          </div>
        </div>
      </div>

      <div class="col-6">
        <div class="card border-cyan h-100">
          <div class="card-body p-3 text-center">
            <i class="bi bi-footprints fs-3 text-cyan mb-2"></i>
            <h4 class="fw-bold mb-1" id="summarySteps">0</h4>
            <small class="text-muted">Total Steps</small>
          </div>
        </div>
      </div>

      <div class="col-6">
        <div class="card border-success h-100">
          <div class="card-body p-3 text-center">
            <i class="bi bi-arrow-repeat fs-3 text-success mb-2"></i>
            <h4 class="fw-bold mb-1" id="summaryTurns">0</h4>
            <small class="text-muted">Turns</small>
          </div>
        </div>
      </div>

    </div>

    <!-- Movement Intensity Chart -->
    <div class="card border-cyan mb-4">
      <div class="card-header bg-dark border-cyan">
        <h6 class="mb-0 fw-bold">
          <i class="bi bi-activity text-cyan me-2"></i>
          Movement Intensity Over Time
        </h6>
      </div>
      <div class="card-body p-3">
        <canvas id="intensityChart" height="150"></canvas>
      </div>
    </div>

    <!-- Session Snapshots -->
    <div class="card border-purple mb-4">
      <div class="card-header bg-dark border-purple">
        <h6 class="mb-0 fw-bold">
          <i class="bi bi-camera text-purple me-2"></i>
          Session Highlights
        </h6>
      </div>

      <div class="card-body p-3">
        <div class="row g-2">

          <div class="col-4">
            <div class="snapshot-placeholder">
              <i class="bi bi-camera fs-1 text-muted"></i>
              <small class="text-muted d-block mt-2">Best Pose</small>
            </div>
          </div>

          <div class="col-4">
            <div class="snapshot-placeholder">
              <i class="bi bi-camera fs-1 text-muted"></i>
              <small class="text-muted d-block mt-2">Peak Movement</small>
            </div>
          </div>

          <div class="col-4">
            <div class="snapshot-placeholder">
              <i class="bi bi-camera fs-1 text-muted"></i>
              <small class="text-muted d-block mt-2">Final Pose</small>
            </div>
          </div>

        </div>
      </div>
    </div>

    <!-- Action Buttons -->
    <div class="d-grid gap-3 pb-4">
      <button class="btn btn-primary btn-lg py-3" onclick="saveAndUpload()">
        <i class="bi bi-cloud-upload me-2"></i>
        Save & Upload Session
      </button>

      <button class="btn btn-outline-cyan" onclick="shareSession()">
        <i class="bi bi-share me-2"></i>
        Share Results
      </button>

      <button class="btn btn-dark" onclick="Navigation.navigate('home')">
        <i class="bi bi-house me-2"></i>
        Back to Home
      </button>
    </div>

  </div>
</div>

 <style>
    .snapshot-placeholder {
        aspect-ratio: 1;
        background: var(--bg-card);
        border: 2px dashed var(--border-secondary);
        border-radius: 12px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 12px;
        }
    .btn-outline-cyan {
        border: 2px solid var(--neon-cyan);
        color: var(--neon-cyan);
        }
    .btn-outline-cyan:hover {
        background: var(--neon-cyan);
        color: white;
        }
 </style>

 <script>
    let sessionData = null;
    // Load session summary data
    async function loadSummaryData() {
    try {
    // Get latest session from database
    const sessions = await Database.getRecentSessions(1);
    if (sessions.length > 0) {
        sessionData = sessions[0];
    displaySummary(sessionData);
    } else {
    // Fallback to Session module if available
    if (window.Session && Session.isActive) {
            sessionData = Session.getSummary();
    displaySummary(sessionData);
    }
    }
    } catch (error) {
    console.error('Error loading summary:', error);
    }
    }
    // Display summary data
    function displaySummary(data) {
    // Score
    const score = Math.round(data.score || 0);
    document.getElementById('summaryScore').textContent = score;
    document.getElementById('summaryScoreBar').style.width = score + '%';
    // Stats
    document.getElementById('summaryDuration').textContent = data.duration || '0:00';
    document.getElementById('summaryBPM').textContent = Math.round(data.avgBPM || 0);
    document.getElementById('summarySteps').textContent = data.steps || 0;
    document.getElementById('summaryTurns').textContent = data.turns || 0;
    // Draw chart
    drawIntensityChart(data);
    }
    // Draw intensity chart
    function drawIntensityChart(data) {
    const canvas = document.getElementById('intensityChart');
    const ctx = canvas.getContext('2d');
    // Generate sample data if not available
    const dataPoints = data.postureReadings || generateSampleData(20);
    new Chart(ctx, {
    type: 'line',
    data: {
    labels: dataPoints.map((_, i) => ''),
    datasets: [{
    label: 'Intensity',
    data: dataPoints,
    borderColor: '#06b6d4',
    backgroundColor: 'rgba(6, 182, 212, 0.1)',
    borderWidth: 3,
    fill: true,
    tension: 0.4,
    pointRadius: 0
    }]
    },
    options: {
    responsive: true,
    maintainAspectRatio: false,
    plugins: {
    legend: { display: false },
    tooltip: { enabled: false }
    },
    scales: {
    y: {
    beginAtZero: true,
    max: 100,
    grid: {
    color: 'rgba(255, 255, 255, 0.1)'
    },
    ticks: {
    color: '#666'
    }
            },
            x: {
            grid: {
                display: false
            },
            ticks: {
                display: false
            }
            }
        }
        }
    });
    }
    // Generate sample data
    function generateSampleData(count) {
    const data = [];
    for (let i = 0; i < count; i++) {
        data.push(Math.random() * 40 + 60); // 60-100 range
    }
    return data;
    }
    // Save and upload
    async function saveAndUpload() {
    try {
        // Data already saved, just show confirmation
        NotificationSystem.showToast('✅Session saved successfully!', 'success');
        
        // Navigate to home after delay
        setTimeout(() => {
        Navigation.navigate('home');
        }, 1500);
    } catch (error) {
        console.error('Save error:', error);
        NotificationSystem.showToast('❌Failed to save session', 'error');
    }
    }
    // Share session
    function shareSession() {
    if (!sessionData) return;
    
    const shareText = `I just completed a ${sessionData.duration} dance session on DanceBud!
    
    Score: ${sessionData.score}%
    Steps: ${sessionData.steps}
    BPM: ${sessionData.avgBPM}
    
    #DanceBud #DanceCoach`;
    
    if (navigator.share) {
        navigator.share({
        title: 'DanceBud Session',
        text: shareText
        }).catch(err => console.log('Share cancelled', err));
    } else {
        // Fallback: copy to clipboard
        navigator.clipboard.writeText(shareText).then(() => {
        NotificationSystem.showToast('✅Copied to clipboard!', 'success');
        });
    }
    }
    // Load data on page show
    loadSummaryData();
 </script>